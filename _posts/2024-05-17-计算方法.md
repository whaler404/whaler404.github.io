---
layout: post
title:  计算方法
# subtitle: 
date:   2024-05-17
author: whaler404
header-img: img/post-bg-playphone.jpg
categories: post math
catalog: true
tags:
    - blog
    - math
---
# Chapt-1.误差

一个大题一个选择题（2.29上课口述）

## 掌握重点

-   掌握方法误差和舍入误差的概念
-   熟练掌握误差、误差限和有效数字的概念
-   掌握有效数字位与误差限之间的关系
-   熟练掌握相对误差和相对误差限的概念
-   掌握相对误差与有效数字的关系
-   了解数值计算中的误差估计(误差传递)
-   掌握数值计算中应该注意的问题

## 方法误差与舍入误差

模型误差:将数学模型与实际问题之间出现的误差(不予讨论)

观测误差:根据观测得到的物理量的误差(不予讨论)

`方法误差`:用数值方法求解得到的近似解和精确解之间的误差<u>（比如说用泰勒展开近似就会产生方法误差）</u>

`舍入误差`:<u>（由于计算机字长有限带来的误差）</u>

-   原始数据在计算机中表示会产生误差,计算过程又可能产生新的误差
-   由原始数据或机器中的十进制数转为二进制数产生的初始误差

## 误差、误差限和有效数字

`误差`:设$x$为准确值,$x^*$为$x$的一个近似值,则称$e^* = x^* - x$​为近似值的`绝对误差`,简称`误差`.

`误差限`:一般我们无法算出准确值$x$,也不能算出误差$e^*$的准确值,只能估算误差的绝对值不超过某个正数$\epsilon^*$,也就是误差绝对值的一个<u>上界</u>,$\epsilon ^*$​称为近似值的`误差限`。

`有效数字：`如果近似值$x^*$的误差限是某一位的半个单位，该位到$x^*$的第一位非零数字共有n位，就说$x^*$有n位有效数字。

## 有效数字位和误差限的关系

按照<u>四舍五入</u>原则得到的近似值的误差<u>不会超过末尾数字的半个单位</u>。

若近似值 $x^*$ 的误差限是某一位的半个单位,该位到 $x^*$ 的第一位非零数字共有n位,就说 $x^*$ 有 $n$ 位有效数字.它可表示为 
$$
x^* = ±10^{m}\times(a_1+a_2\times10^{-1}+...+an\times10^{-n-1})
$$
其中 $a_i(i=1,2,...,n)$ 是 $0$ 到 $9$ 中的一个数字, $a_1\neq0$, $m$ 为整数,且
$$
|\frac{x-x^*}{x^*}| \leqslant \frac{1}{2}\times10^{m-n+1}
$$
例如,取 $x^*=3.14$ 作 $\pi$ 的近似值, $x^*$ 就有 $3$ 位有效数字,取 $x^*=3.1416\approx\pi$, $x^*$ 就有 $5$ 位有效数字.

## 相对误差和相对误差限

相对误差：近似值的误差$e^*$与准确值$x$的比值。
$$
\frac{e^x}{x} = \frac{x^* -x}{x^*}
$$
通常取$e^*_r = \frac{e^*}{x^*} = \frac{x^* - x}{x^*}$作为相对误差，条件是$e^*_r = \frac{e^x}{x^*}$较小。

相对误差的绝对值上界叫做相对误差限，记作$\epsilon^*_r = \frac{\epsilon^*}{|x^*|}$

## 相对误差与有效数字的关系

有效位数越多，相对误差限越小

设近似数 $x^*$ 表示为 
$$
x^* = \pm 10^{m}\times(a_1+a_2\times10^{-1}+\cdots+a_i\times10^{-n-1})
$$
其中 $a_i(i=1,2,...,l)$ 是 $0$ 到 $9$ 中的一个数字，$a_1\neq0$ ，$m$ 为整数。若 $x^*$ 有 $n$ 位有效数字，则其相对误差限 
$$
\varepsilon^*\leq\frac{1}{2a_1}\times10^{-(\n-1)}
$$


反之，若 $x^*$ 的相对误差限 $\varepsilon^*\leq\frac{1}{2(a_1+1)}\times10^{-(n-1)}$ ，则 $x^*$至少具有n位有效数字。



## 数值计算中的误差估计(误差传递)

设两个近似数$x^{*}_{1}$与$x^{*}_{2}$的误差限分别为$ε(x^{*}_{1})$及$ε(x^{*}_{2})$，则它们进行加、减、乘、除运算得到的误差限分别满足不等式

==以下公式用泰勒展开来记忆，$df =  f_x \Delta x + f_y \Delta y$，其中$\Delta x$ 就等于误差限$\epsilon (x^*)$。==
$$
\varepsilon (x^{*}_{1}\pm x^{*}_{2})\leq\varepsilon (x^{*}_{1})+\varepsilon (x^{*}_{2})
\\
\varepsilon (x^{*}_{1}x^{*}_{2})\leq|{x_{1}^{*}}|\varepsilon (x^{*}_{2})+|x_{2}^{2}|\varepsilon (x^{*}_{1})
\\
\varepsilon (x^{*}_{1}/x^{*}_{2})\leq\frac{|{x_{1}^{*}}|\varepsilon (x^{*}_{2})+|{x_{2}^{*}}|\varepsilon (x^{*}_{1})}{|x_{2}^*|^{2}},x^*_2\neq0
$$
更一般的情况采用`泰勒展开`来证明，误差限
$$
\epsilon(A^*) \approx \Sigma^n_{k = 1}| (\frac{\partial f}{\partial x_k})^*|\epsilon (x^*_k)
$$

## 数值计算中应该注意的问题

-   算法的`数值稳定性`：如果一个算法输入数据有误差，而在计算过程中舍入误差不增长，则称此算法是数值稳定的，否则为不稳定的。
-   `病态问题`和`条件数`：如果一个数值问题本身输入数据有误差，引起输出数据相对误差很大，就是病态问题。相对误差比值$C_P$为计算函数值问题的条件数，如果很大，将引起病态问题。
-   `避免误差危害`：
    -   `避免两个相近的数相减`
    -   防止小数被大数“吃掉”，导致`有效数字`损失。（大数和小数参与加减运算）
    -   注意`减少运算次数`（如n阶多项式求和可以采用秦九韶算法降低乘法次数）
    -   `避免除绝对值很小的数`
    -   选择`数值稳定`的计算公式（注意数值稳定性）

# Chap-2.插值

## 掌握重点

-   掌握插值和代数插值的概念
-   熟练掌握差商的定义
-   掌握线性插值、二次插值与n次插值的推导过程、计算过程、在计算机上如何实现以及误差估计
-   掌握分段插值的概念、计算过程，在计算机上如何实现以及误差估计
-   了解Hermite插值和分段三次Hermite插值的推导过程和计算过程
-   掌握三次样条插值的推导过程和计算过程
-   了解求数值微分的方法。

## 插值和代数插值

​	设函数$$y=f(x)$$在区间$$[a,b]$$上有定义且已知在点$a\le x_0<x_1<...<x_n\le b$上的值$y_0，y_1,...,y_n$，若存在一简单函数$P(x)$，使
$$
P(x_i)=y_i，i=0,1,...,n
$$


成立，就称$P(x)$为$f(x)$的插值函数，点$x_0，x_1，...,x_n$称为插值节点，包含插值节点的区间$[a,b]$称为插值区间，求插值函数$P(x)$的方法称为插值法。若$P(x)$是次数不超过$n$的代数多项式，即
$$
P(x)=a_0+a_1x+\cdots+a_{n}x^{n}
$$
其中$a_i$为实数,就称$P(x)$为`插值多项式`,相应的插值法称为`多项式插值`。若$P(x)$为分段的多项式,就称为`分段插值.`若$P(x)$​为三角多项式,就称为`三角插值`。

简单来说，就是根据数据表构造出一个函数$\varphi(x)$来近似替代$f(x)$,如果这个$\varphi(x)$是一个**代数多项式**，则称为**代数插值**。



## 线性插值、二次差值、n次差值的拉格朗日形式

### 线性插值

给定区间$[x_0,x_1]$，端点值$y_0=f(x_0),\quad y_1=f(x_1)$，求插值多项式，使其满足$L_1(x_0)=y_0,\quad L_1(x_1)=y_1$

拉格朗日形式：由直线两点式方程转换而来
$$
L_1(x)=\frac{x-x_1}{(x_0-x_1)}y_0+\frac{x-x_0}{(x_1-x_0)}y_1 \\
令l_0=\frac{x-x_1}{(x_0-x_1)}y_0 \quad l_1=\frac{x-x_0}{(x_1-x_0)}y_1 \\
L_1(x)=l_0(x)y_0+l_1(x)y_1
$$
我们称$l_0(x),l_1(x)$为线性插值基函数，$y_0,y_1$为系数，在节点$x_0,x_1$上分别满足
$$
l_0(x_0)=1\quad l_1(x_0)=0 \\
l_0(x_1)=0\quad l_1(x_1)=1
$$


### 二次差值

给定区间$[x_0,x_1]$，端点值$y_0=f(x_0),\quad y_1=f(x_1),\quad y_2=f(x_2)$，求插值多项式，使其满足$L_2(x_0)=y_0,\quad L_2(x_1)=y_1,\quad L_2(x_2)=y_2$，基函数形式表示为：
$$
L_2(x)=l_0(x)y_0+l_1(x)y_1+l_2(x)y_2 \\
基函数应该为二次函数，在节点上分别满足条件 \\
\left\{
\begin{array}{**lr**}
l_0(x_0)=1 & l_1(x_0)=0 & l_2(x_0)=0 \\
l_0(x_1)=0 & l_1(x_1)=1 & l_2(x_1)=0 \\
l_0(x_2)=0 & l_1(x_2)=0 & l_2(x_2)=1 \\
\end{array}
\right.
$$
以$l_0(x)$为例，使用待定系数法求基函数
$$
\because l_1(x_0)=0,l_2(x_0)=0 \quad \therefore 设 l_0(x)=A(x-x_1)(x-x_2) \\
又\because l_0(x_0)=1 \quad \therefore A=\frac{1}{(x_0-x_1)(x_0-x_2)}
$$
综上，二次插值的拉格朗日形式为
$$
L_2(x)=\frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)}y_0+ \\
\frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)}y_1+
\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)}y_2+
$$

### n次差值

通过上述类似的推导方法，可以得到$n$次插值基函数为：
$$
l_k(x)=\frac{(x-x_0)\cdots(x-x_{k-1})(x-x_{k+1})\cdots(x-x_n)}
{(x_k-x_0)\cdots(x_k-x_{k-1})(x_k-x_{k+1})\cdots(x_k-x_n)}
$$
拉格朗日插值多项式$L_n(x)$为：
$$
L_n(x)=\sum\limits_{k=0}^{n}y_kl_k(x) \\
其中 \quad l_k(x)=\frac{w_{n+1}(x)}{(x-x_k)w_{n+1}'(x_k)} \\
w_{n+1}(x)=(x-x_0)\cdots(x-x_k)\cdots(x-x_n) \\
w_{n+1}'(x_k)=(x_k-x_0)\cdots(x_k-x_{k-1})(x_k-x_{k+1})\cdots(x_k-x_n)
$$

### 插值余项和误差估计

- 插值余项定义：若在$[a,b]$上用$L_n(x)$近似$f(x)$，其截断误差为$R_n(x)=f(x)-L_n(x)$，也称为插值多项式的余项

- 定理：设$f^{(n)}(x)$在$[a,b]$上连续，$f^{(n+1)}(x)$在$(a,b)$内存在，节点$a\le x_0<\cdots<x_n\le b$；$L_n(x)$是满足条件的插值多项式，对任何$x\in [a,b]$，插值余项
  $$
  R_n(x)=f(x)-L_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}w_{n+1}(x)
  $$
  $\xi \in(a,b)$，且依赖于$x$

  **证明：**由插值函数的定义可知，余项在插值节点的值为0，即$R_n(x_k)=0$，由待定系数法，可以得到余项的多项式形式
  $$
  R_n(x)=K(x)(x-x_0)\cdots(x-x_n)=K(x)w_{n+1}(x)
  $$
  将$x$当作$[a,b]$上的一个固定点，设函数
  $$
  \varphi(t)=f(t)-L_n(t)-K(x)(t-x_0)\cdots(t-x_n)
  $$
  根据$f$的假设可以知道$\varphi ^{(n)}(t)$在$[a,b]$上连续，$\varphi^{(n+1)}(t)$在$(a,b)$内存在，$\varphi(x_k)=0$

  根据罗尔定理：$\varphi '(t)$在$\varphi(t)$的两个零点之间至少有一个零点

  已知$\varphi(t)$在$x_0,\cdots ,x_n$以及不动点$x$处均为零，共$n+2$个零点，所以$\varphi'(t)$在$[a,b]$内至少有$n+1$个零点，然后对$\varphi'(t)$再次用罗尔定理，以此类推

  $\varphi^{(n+1)}(x)$内至少有一个零点，记为$\xi\in(a,b)$使得
  $$
  \varphi^{(n+1)}(\xi)=f^{(n+1)}(\xi)-(n+1)!K(x)=0 \\
  K(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}
  $$

  余项表达式只有在$f(x)$的高阶导数存在时才能应用，求出$\max\limits_{a\le x\le b}|f^{(n+1)}(x)|=M_{n+1}$，插值多项式逼近原函数的截断误差限为
  $$
  |R_n(x)|\le \frac{M_{n+1}}{(n+1)!}|w_{n+1}(x)|
  $$

- 定理：对于$f(x)=x^k,(k\le n)$，由于$R_n(x)=x^k - \sum\limits_{i=0}^n x_i^k l_i(x)=0$，所以
  $$
  x^k = \sum\limits_{i=0}^n x_i^k l_i(x),k\le n
  $$



## 差商

拉格朗日插值的缺点：利用插值基函数可以容易得到拉格朗日插值多项式，公式结构紧凑，但当插值节点增减时，计算要全部重新进行

- 设计一种逐次生成插值多项式的方法，先考察$n=1$的情形，满足$P_1(x_0)=f(x_0),P_1(x_1)=f(x_1)$，点斜式表示为

$$
P_1(x)=f(x_0)+\frac{f(x_1)-f(x_0)}{x_1-x_0}(x-x_0) \\
可以当作零次插值 P_0(x)=f(x_0)的修正 \\
P_1(x)=P_0(x)+a_1(x-x_0) \\
a_1=\frac{f(x_1)-f(x_0)}{x_1-x_0}是函数f(x)的差商
$$

- 然后考虑$n=2$的情况$P_2(x_0)=f(x_0)=P_1(x_0),P_2(x_1)=f(x_1)=P_1(x_1),P_2(x_2)=f(x_2)$，可以表示为

$$
P_2(x)=P_1(x)+a_2(x-x_0)(x-x_1) \\
a_2= \frac{P_2(x_2)-P_1(x_2)}{(x_2-x_0)(x_2-x_1)} \\
= \frac{f(x_2)-(f(x_0)+\frac{f(x_1)-f(x_0)}{x_1-x_0}(x_2-x_0))}
{(x_2-x_0)(x_2-x_1)} \\
=\frac{\frac{f(x_2)-f(x_0)}{x_2-x_0}-\frac{f(x_1)-f(x_0)}{x_1-x_0}}
{x_2-x_1} \\
a_2是函数f(x)的差商
$$

- 推广到一般情况，$f(x)$有$n+1$个插值节点，$n$次插值多项式$P_n(x)$满足条件$P_n(x_i)=f(x_i)$，插值多项式表示为
  $$
  P_n(x)=a_0+a_1(x-x_0)+\cdots+a_n(x-x_0)\cdots(x-x_{n-1})
  $$
  和拉格朗日插值不同，$P_n(x)$由基函数$\{1,x-x_0,\cdots,(x-x_0)\cdots(x-x_{n-1})\}$逐次递推得到，为了给出系数$a_i$的表达式，需要引入差商的定义

- 一阶差商定义：
  $$
  f[x_0,x_k]=\frac{f(x_k)-f(x_0)}{x_k-x_0}
  $$
  为函数$f(x)$关于点$x_0,x_k$的一阶差商

  二阶差商定义：
  $$
  f[x_0,x_1,x_k]=\frac{f[x_0,x_k]-f[x_0,x_1]}{x_k-x_1}
  $$
  $k$阶差商定义：
  $$
  f[x_0,x_1,\cdots,x_k]=\frac
  {f[x_0,x_1,\cdots,x_{k-2},x_{k}]-f[x_0,x_1,\cdots,x_{k-2},x_{k-1}]}
  {x_k-x_{k-1}}
  $$

- 差商的基本性质：

  - $k$阶差商可以表示为函数值$f(x_0),\cdots,f(x_{k})$的线性组合
    $$
    f[x_0,\cdots,x_k]=\sum\limits_{j=0}^k
    \frac{f(x_j)}{(x_j-x_0)\cdots(x_j-x_{j-1})(x_j-x_{j+1})\cdots(x_j-x_k)} \\
    = \sum\limits_{j=0}^k\frac{x_j}{w_{k+1}'(x_j)}
    $$
    归纳法证明，此性质也可以证明均差和节点的排列次序无关，称为均差的**对称性**

  - 通过上一个性质可以得到
    $$
    f[x_0,\cdots,x_k]=\frac
    {f[x_1,\cdots,x_k]-f[x_0,\cdots,x_{k-1}]}{x_k-x_0}
    $$

  - 若$f(x)$在$[a,b]$上存在$n$阶倒数，且节点$x_0,\cdots,x_n \in[a,b]$，则$n$阶差商和导数的关系为
    $$
    f[x_0,\cdots,x_n]=\frac{f^{(n)}(\xi)}{n!}
    $$
    罗尔定理证明

- 差商计算可以列出差商表（通过上面第二条性质）
  $$
  \begin{vmatrix}
  x_k & f(x_k) & 一阶差商 & 二阶差商 & 三阶差商 & 四阶差商\\
  x_0 & f(x_0) & & & &\\ 
  x_1 & f(x_1) & f[x_0,x_1] & & &\\
  x_2 & f(x_2) & f[x_1,x_2] & f[x_0,x_1,x_2] & &\\
  x_3 & f(x_3) & f[x_3,x_2] & f[x_1,x_2,x_3] & f[x_0,x_1,x_2,x_3] &\\
  x_4 & f(x_4) & f[x_4,x_3] & f[x_2,x_3,x_4] & f[x_1,x_2,x_3,x_4] 
  & f[x_0,x_1,x_2,x_3,x_4]\\
  \end{vmatrix}
  $$



## 线性插值、二次差值、n次差值的牛顿形式

- 牛顿插值多项式定义：
  $$
  P_k(x)=P_{k-1}(x)+f[x_0,\cdots,x_k](x-x_0)\cdots(x-x_{k-1}) \\
  递推得到牛顿插值多项式 \\
  P_n(x)=f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)+\cdots \\
  +f[x_0,\cdots,x_n](x-x_0)\cdots(x-x_{n-1}) \\
  插值余项为 \\
  R_n(x)=f[x,x_0,\cdots,x_n]w_{n+1}(x)
  $$
  推导过程：根据差商定义，将$x$当作$[a,b]$上的一点，即$x_{-1}$，根据差商性质第二条
  $$
  f(x)=f(x_0)+f[x,x_0](x-x_0) \\
  f[x,x_0]=f[x_0,x_1]+f[x,x_0,x_1](x-x_1) \\
  \vdots \\
  f[x,x_0,\cdots,x_{n-1}]=f[x_0,\cdots,x_n]+f[x,x_0,\cdots,x_n](x-x_n) \\
  递推得到 \\
  f(x)=f(x_0)+f[x_0,x_1](x-x_0)+\cdots+f[x_0,\cdots,x_n]
  (x-x_0)\cdots(x-x_{n-1}) \\+f[x,x_0,\cdots,x_n](x-x_0)\cdots(x-x_{n}) \\
  =P_n(x)+R_n(x)
  $$
  



## Hermite插值

要求插值函数在插值节点上的**值相同**，也要求在插值节点的**一阶导数相同**。

- 定理：设$f\in C^n[a,b]$，$x_0\cdots x_n$为区间内的相异节点，则$f[x_0,x_1,\cdots,x_n]$是其变量的连续函数（证明略）

  根据差商的定义，有
  $$
  \lim\limits_{x\rightarrow x_0}f[x_0,x]=
  \lim\limits_{x\rightarrow x_0}\frac{f(x)-f(x_0)}{x-x_0}=f'(x_0) \\
  $$

- $n$重节点差商定义：根据上面的定理，定义重节点均差
  $$
  f[x_0,x_0]=\lim\limits_{x\rightarrow x_0}f[x_0,x]=f'(x_0)
  $$
  同理可推
  $$
  \lim\limits_{x\rightarrow x_0}f[x_0,x_0,x]=
  \lim\limits_{x\rightarrow x_0}\frac{f[x,x_0]-f[x_0,x_0]}{x-x_0}
  =\lim\limits_{x\rightarrow x_0}\frac{f'(x)-f'(x_0)}{x-x_0}=f''(x_0) \\
  f[x_0,x_0,x_0]=\lim\limits_{x_1\rightarrow x_0 x_2 \rightarrow x_0}
  f[x_0,x_1,x_2]=\frac{1}{2}f''(x_0)
  $$
  一般地
  $$
  f[x_0,x_0,\cdots,x_0]=\frac{1}{n!}f^{(n)}(x_0)
  $$

- 泰勒多项式定义：在牛顿差商插值多项式中，若令所有的$x_i\rightarrow x_0$，从$n$重节点差商可以得到泰勒多项式
  $$
  P_n(x)=f(x_0)+f'(x_0)(x-x_0)+\cdots+\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n
  $$
  由于泰勒多项式是在$x_0$附近逼近$f(x)$的带导数的插值多项式，其满足条件$P_n^{(k)}(x_0)=f^{(k)}(x_0)$，所以它是一个埃尔米特插值多项式，其余项为
  $$
  R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}
  $$
  泰勒插值是牛顿插值的极限形式



### 三次Hermite插值

- 三次Hermite插值函数定义：给定$f(x)$的函数表，构造函数$H(x)$满足条件
  $$
  \begin{vmatrix}
  x & x_0 & x_1 \\
  y=f(x) & y_0 & y_1 \\
  y'=f'(x) & m_0 & m_1
  \end{vmatrix}
  $$

  - $H(x)$不超过3次的代数多项式

- 设$H(x)=y_0h_0(x)+y_1h_1(x)+m_0H_0(x)+m_1H_1(x)$，满足
  $$
  \begin{vmatrix}
   & 函数值 &   & 导数值 & \\
   & x_0 & x_1 & x_0 & x_1  \\
  h_0(x) & 1 & 0 & 0 & 0 \\
  h_1(x) & 0 & 1 & 0 & 0 \\
  H_0(x) & 0 & 0 & 1 & 0 \\
  H_1(x) & 0 & 0 & 0 & 1 \\
  \end{vmatrix}
  $$
  得到
  $$
  h_0=(1+2\frac{x-x_0}{x_1-x_0})(\frac{x-x_0}{x_1-x_0})^2 \\
  h_1=(1+2\frac{x-x_1}{x_0-x_1})(\frac{x-x_1}{x_0-x_1})^2 \\
  H_0=(x-x_0)(\frac{x-x_1}{x_0-x_1})^2 \\
  H_1=(x-x_1)(\frac{x-x_0}{x_1-x_0})^2 \\
  $$

- Hermite插值误差

  设$H(x)$是$f(x)$的三次Hermite插值，$[a,b]$是包含$x_0,x_1$的任一区间，总存在一点$\xi \in (a,b)$，使得
  $$
  R(x)=f(x)-H(x)=\frac{f^{4}(\xi)}{4!}(x-x_0)^2(x-x_1)^2
  $$

- $2n+1$次插值及其余项

## 分段插值

对于给定的$n+1$个节点可以构造出唯一的$n$阶插值多项式，但并不是差值多项式的次数越高，误差就越小。所以可以分区间分段进行差值，在每个分段内部进行低次的差值。

### 分段线性插值

分段线性插值就是通过折线段连接插值节点逼近$f(x)$，在每个小区间$[x_k,x_{k+1}]$上可以表示为
$$
I_h(x)=\frac{x-x_{k+1}}{x_k-x_{k+1}}f_k+\frac{x-x_{k}}{x_{k+1}-x_{k}}f_{k+1}\\
x_k\le x\le x_{k+1}
$$
误差估计通过插值余项可以得到
$$
\max\limits_{x_k\le x\le x_{k+1}}|f(x)-I_h(x)|\le
\frac{M_2}{2}\max\limits_{x_k\le x\le x_{k+1}}|(x-x_k)(x-x_{k+1})|\\
M_2=\max\limits_{a\le x\le b}|f''(x)|
$$


### 分段三次Hermite

分段线性插值函数的导数是间断的，如果在插值节点上除了知道函数值$f(x_k)$，还知道导数值$f'(x_k)=m_k$，可构造一个导数连续的分段插值函数，每个小区间上$I_h(x)$是三次多项式

（太复杂了不考）

基函数这一部分应该了解就可以，不要求完全写出。

误差：

计算机算法实现：

### 三次样条插值

分段三次Hermite插值只有一阶导数连续，二阶导数不连续。而且实际过程中难以给出导数条件。三次样条差值利用二阶导数相等和边界情况创造条件，进行插值。

- 三次样条函数定义：函数$S(x)\in C^2[a,b]$，在每个小区间$[x_j,x_{j+1}]$上是三次多项式，则称$S(x)$是节点$x_0,\cdots,x_n$上的三次样条函数；$S(x_j)=y_j$成立

- 根据定义可知，每个小区间上的三次样条函数有4个待定系数，所有区间总共$4n$个参数；样条函数满足连续型条件，总共$4n-2$个条件
  $$
  S(x_j)=y_j \\
  S(x_j-0)=S(x_j+0)\\
  S'(x_j-0)=S'(x_j+0)\\
  S''(x_j-0)=S''(x_j+0)
  $$
  需要再增加2个条件才能确定$S(x)$，通常在端点上个加上一个条件（边界条件），有一下三种：

  - $S'(x_0)=f_0',S'(x_n)=f_n'$

  - $S''(x_0)=f_0'',S''(x_n)=f_n''$

    特殊的，$S''(x_0)=S''(x_n)=0$称为自然边界条件

  - 周期样条函数（省略）



样条插值函数的建立

有多种方法可以构造三次样条插值函数，满足插值条件和相应的边界条件

分段三次埃米尔特插值：假定$S'(x_j)=m_j$，满足$S(x_j)=y_j$，得到
$$
S(x)=\sum\limits_{j=0}^{n}[y_j\alpha_j(x)+m_j\beta_j(x)] \\
\alpha_k(x)=(1+2\frac{x-x_{k+1}}{x_k-x_{k+1}})(\frac{x-x_k}{x_{k+1}-x_k})^2\\
\beta_k(x)=(x-x_k)(\frac{x-x_{k+1}}{x_k-x_{k+1}})^2
$$
$\alpha_j(x),\beta_j(x)$之前得到的插值基函数，通过之前的插值条件和边界条件，构造关于$m_j$的三对角方程组，解$m_j$得到所求的三次样条函数$S(x)$

（后面太复杂不考）

## 数值微分

# Chapt-3.数据拟合

## 单变量数据拟合及最小二乘法

给定数据表，表示自变量和因变量的关系，使用单变量数据拟合法，寻找近似函数代替$f(x)$

$F(x)$拟合函数，$f(x)$被拟合函数

- 偏差定义：拟合函数和被拟合函数在$x_i$的偏差，记为$\delta_i=f(x_i)-F(x_i)$

- 最小二乘法定义：偏差平方和的最小值
  $$
  \min\sum\limits_{i=1}^n\delta_i^2=\sum\limits_{i=1}^{n}[f(x_i)-F(x_i)]^2
  $$

- 最小二乘直线定理：给定$y=f(x)$数据表$(x_i,y_i)$，如果散点答题满足线性函数，拟合函数为
  $$
  F(x)=a+bx \\
  待定参数a和b是正规方程组的解 \\
  \left\{
  \begin{array}{**lr**}
  na+(\sum\limits_{i=1}^nx_i)b=\sum\limits_{i=1}^ny_i \\
  (\sum\limits_{i=1}^nx_i)a+(\sum\limits_{i=1}^nx_i^2)b
  =\sum\limits_{i=1}^nx_iy_i
  \end{array}
  \right.
  $$
  

## 多变量数据拟合及最小二乘法

实际中自变量有多个，自变量记为${x_k}$，因变量记为$y$
$$
F(x_1,x_2,\cdots,x_k)=a_0+a_1x_1+\cdots+a_kx_k
$$
最小二乘法确定待定参数，偏差平方和：
$$
\varphi(a_0,a_1,\cdots ,a_k)=\sum\limits_{m=1}^{n}
(y_k-a_0-a_1x_{m1}-a_2x_{m2}-\cdots -a_kx_{mk})^2
$$
多元函数求极小值方法：对偏差平方和求参数的偏导数并令其等于零
$$
\min\varphi(a_0,a_1,\cdots,a_k) \\
\frac{\partial\varphi}{\partial a_i}=0 \\
求解 \\
\left\{
\begin{array}{**lr**}
na_0 &+a_1\sum\limits_{m=1}^{n}x_{m1} &+a_2\sum\limits_{m=1}^{n}x_{m2} 
&+\cdots &+a_k\sum\limits_{m=1}^{n}x_{mk}= & \sum\limits_{m=1}^{n}y_{m} \\

a_0\sum\limits_{m=1}^{n}x_{m1} &+a_1\sum\limits_{m=1}^{n}x_{m1}x_{m1} &+a_2\sum\limits_{m=1}^{n}x_{m2}x_{m1} 
&+\cdots &+a_k\sum\limits_{m=1}^{n}x_{mk}x_{m1}= & \sum\limits_{m=1}^{n}y_{m}x_{m1} \\

a_0\sum\limits_{m=1}^{n}x_{m2} &+a_1\sum\limits_{m=1}^{n}x_{m1}x_{m2} &+a_2\sum\limits_{m=1}^{n}x_{m2}x_{m2} 
&+\cdots &+a_k\sum\limits_{m=1}^{n}x_{mk}x_{m2}= & \sum\limits_{m=1}^{n}y_{m}x_{m2}x_{m2} \\

& \vdots\\

a_0\sum\limits_{m=1}^{n}x_{mk} &+a_1\sum\limits_{m=1}^{n}x_{m1}x_{mk} &+a_2\sum\limits_{m=1}^{n}x_{m2}x_{mk} 
&+\cdots &+a_k\sum\limits_{m=1}^{n}x_{mk}x_{mk}= & \sum\limits_{m=1}^{n}y_{m}x_{mk} \\
\end{array}
\right.
$$


## 非线性数据线性化

原始数据不呈现线性关系，先将原始数据变换，使得变换后的数据呈现线性关系
$$
y=a+b\ln x \quad\longrightarrow\quad X=\ln x,Y=y \\
y=ae^{bx} \quad\longrightarrow\quad X=x,Y=\ln y \\
$$


## 线性模型最小二乘解的几何解释



## 线性模型最小二乘解的矩阵解释



## 正交多项式拟合

- 多项式拟合定义：将多项式拟合函数变成多变量拟合函数
  $$
  m次多项式函数 \\
  y^*=\Psi_m(x)=a_0p_0(x)+a_1p_1(x)+\cdots+a_mp_m(x)
  =\sum\limits_{k=0}^ma_kp_k(0) \\
  \delta_i=y_i-y_i^*=y_i-\sum\limits_{k=0}^ma_kp_k(x_i)
  $$
  需要求解一个正规方程组，当多项式次数较高时，正规方程组可能会病态

  - 病态方程组定义：$Ax=b$中的系数矩阵和常数项发生微小变化，会引起方程组的解很大变化

- 通常在$\delta_i$前面乘上一个表示数据精度的权数$w_i$
  $$
  \varphi(a_0,a_1,\cdots,a_m)=\sum\limits_{i=1}^{n}w_i\delta_i^2
  $$
  求解加权偏差平方和最小，转化为求解目标函数的极小值问题
  $$
  \frac{\partial\varphi}{\partial a_j}=
  -2\sum\limits_{i=1}^nw_i[y_i-\sum\limits_{k=0}^ma_kp_k(x_i)]p_j(x_i)=0 \\
  移项得到\sum\limits_{i=1}^n p_j(x_i) w_i y_i=
  \sum\limits_{i=1}^n  p_j(x_i) w_i[\sum\limits_{k=0}^ma_k p_k(x_i)] \\
  交换求和顺序得到\\
  \sum\limits_{k=0}^ma_k[\sum\limits_{i=1}^n  p_j(x_i) w_i p_k(x_i)]
  = \sum\limits_{i=1}^n p_j(x_i) w_i y_i \\
  令c_{jk}=\sum\limits_{i=1}^n  p_j(x_i) w_i p_k(x_i),\quad
  b_j=\sum\limits_{i=1}^n p_j(x_i) w_i y_i \\
  $$
  得到正规方程组
  $$
  \sum\limits_{k=0}^m c_{jk}a_k=b_j
  $$
  

## 避免过拟合

过拟合通常表现为拟合模型的**高方差和低偏差**，欠拟合表现为拟合模型的**低方差和高偏差**

防止过拟合通常采用正则化项
$$
F(x,\theta)=w_0+\theta_1x^1+\theta_2x^2+\cdots++\theta_Mx^M
=\sum\limits_{i=0}^M\theta_ix^i
$$
$L_2$正则化：$\varphi(x,\theta)=\frac{1}{2}\{F(x,\theta)-y_i\}^2+\frac{\lambda}{2}||\theta||_2^2$

$L_1$正则化：$\varphi(x,\theta)=\frac{1}{2}\{F(x,\theta)-y_i\}^2+\frac{\lambda}{2}||\theta||_1^2$

带$L_2$正则项的最小二乘解：$\theta=(A^TA+I)^{-1}A^Tb$




# Chapt-4.数值积分

根据代数插值法，对于任意被积函数$f(x)$，都可以构造一个插值多项式$p(x)$来近似代替，两边积分$\int_a^bf(x)dx\approx\int_a^b p(x)dx$

一般地，在区间$[a,b]$上选取节点$x_i$，然后用$f(x_i)$的加权平均得到平均高度$f(\zeta)$的近似值，求积公式具有一下形式
$$
\int_a^b f(x)\approx \sum\limits_{i=1}^n A_kf(x_k) \\
x_k求积节点\\
A_k求积系数，A_k的选择只和x_k有关，和f(x)无关
$$

## 梯形/Simpson/Newton-Cotes公式

- 梯形求积公式：一次代数插值，用两点$(a,f(a)),(b,f(b))$
  $$
  \int_a^b f(x)dx\approx \int_a^b 
  [\frac{x-b}{a-b}f(a)+\frac{x-a}{b-a}f(b)]dx \\
  = \frac{a-b}{2}[f(a)+f(b)]
  $$

- Simpson求积公式：二次代数插值，用三点$(a,f(a)),(\frac{a+b}{2},f(\frac{a+b}{2})),(b,f(b))$
  $$
  \int_a^b f(x)dx\approx
  \int_a^b 
  [\frac{(x-\frac{a+b}{2})(x-b)}{(a-\frac{a+b}{2})(a-b)}f(a)\\
  +\frac{(x-a)(x-b)}{(\frac{a+b}{2}-a)(\frac{a+b}{2}-b)}f(\frac{a+b}{2})\\
  +\frac{(x-a)(x-\frac{a+b}{2})}{(b-a)(b-\frac{a+b}{2})}f(b)]dx \\
  = \frac{b-a}{6}[f(a)+4f(\frac{a+b}{2})+f(b)]
  $$

- Newton-Cotes求积公式：把积分区间$[a,b]$划分$n$等分，得到$n+1$个积分节点$x_i=a+ih,(i=0,1,\cdots,n)$，其中$h=\frac{b-a}{n}$
  $$
  f(x)\approx p_n(x)=\sum\limits_{i=0}^{n}
  \frac{\omega(x)}{(x-x_i)\omega'(x_i)}f(x_i) \\
  其中\omega(x)=(x-x_0)(x-x_1)\cdots(x-x_n) \\
  \omega'(x_i)=(x_i-x_0)\cdots(x_i-x_{i-1})(x_i-x_{i+1})\cdots(x_i-x_n) \\
  $$
  求积公式表示为
  $$
  \int_a^b f(x)dx\approx \int_a^b \sum\limits_{i=0}^{n}
  \frac{\omega(x)}{(x-x_i)\omega'(x_i)}f(x_i) dx \\
  = \sum\limits_{i=0}^{n}[\int_a^b 
  \frac{\omega(x)}{(x-x_i)\omega'(x_i)}f(x_i)dx] \\
  = \sum\limits_{i=0}^{n}A_i f(x_i) \\
  其中 A_i=\int_a^b\frac{\omega(x)}{(x-x_i)\omega'(x_i)}dx
  $$
  经过一堆复杂的计算，得到$A_i=(b-a)c_i^{(n)}$，其中$c_i^{(n)}$为Newton-Cotes系数，一般直接使用系数表
  
  | $n$  | $c_0^{(n)}$   | $c_1^{(n)}$              | $c_2^{(n)}$              | $c_3^{(n)}$   |
  | ---- | ------------- | ------------------------ | ------------------------ | ------------- |
  | 1    | $\frac{1}{2}$ | $\frac{1}{2}$            |                          |               |
  | 2    | $\frac{1}{6}$ | $\frac{4}{6}$            | $\frac{1}{6}$            |               |
  | 3    | $\frac{1}{8}$ | $\frac{3}{8}$ 			| $\frac{3}{8}$	| $\frac{1}{8}$ |
  
  所有系数之和为1？

## 求积公式的代数精度

数值积分是近似方法，为了保证精度，求积公式应该对“尽可能”多的函数准确成立，**代数精度**就是用来描述求积公式这种“性能”的方法

- 积分近似公式具有**$n$次代数精度**定义：设任意一个次数不高于$n$次的代数多项式$f(x)$，对于一般求积公式，积分近似公式$\int_a^b f(x)dx\approx \sum\limits_{k=0}^m A_k f(x_k)$精确成立，而当$f(x)$是$n+1$次代数多项式时不精确成立

  一般的，$n$次代数精度的求积公式$\sum\limits_{k=0}^m A_kf(x_k)$对于$f(x)=1,x,\cdots,x^n$都准确成立
  $$
  \left\{
  \begin{array}{**lr**}
  \sum\limits_{k=0}^m A_k x_k^0=\int_a^b xdx=b-a \\
  \sum\limits_{k=0}^m A_k x_k^1=\int_a^b x^2dx=\frac{1}{2}(b^2-a^2) \\
  \vdots \\
  \sum\limits_{k=0}^m A_k x_k^n=\int_a^b x^ndx=\frac{1}{n+1}(b^{n+1}-a^{n+1})
  \end{array}
  \right.
  $$

- 定理：梯形求积公式具有1次代数精度

  定理：Simpson求积公式具有3次代数精度

  定理：Newton-Cotes公式至少具有n次代数精度，当n为偶数时，代数精度至少为n+1次
  $$
  代数插值多项式的余项公式：\\
  R_n(x)=f(x)-p_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega(x)\\
  设n是偶数，f(x)=\sum\limits_{k=0}^{n+1}b_kx^k \\
  \int_a^b R_n(x)dx=\int_a^b \frac{f^{(n+1)}(\xi)}{(n+1)!}\omega(x) dx \\
  = \int_a^b \frac{b_{n+1}(n+1)!}{(n+1)!}\omega(x) dx
  = b_{n+1}\int_a^b \omega(x)dx=0 \\
  \because \omega(x)=(x-x_0)\cdots(x-x_{n})关于(x_{\frac{n}{2}},0)中心对称
  $$

- 加权积分中值定理：如果$f(x)$在$[a,b]$上连续，$g$在$[a,b]$可积并且$\forall x\in[a,b],g(x)\ge 0$（不变号），则：
  $$
  \int_a^b f(x)g(x)dx=f(\xi)\int_a^b g(x)dx，\xi\in[a,b]
  $$
  

## 梯形和Simpson求积公式误差估计

- 定理：若$f(x)\in C^2[a,b]$，梯形公式误差估计为：
  $$
  \int_a^b f(x)dx-\frac{b-a}{2}[f(a)+f(b)]=-\frac{(b-a)^3}{12}f''(\eta) \\
  其中a\le \eta \le b \\
  \int_a^b R(x)dx=-\int_a^b \frac{f''(\xi)}{2}(a-x)(x-b)dx \\
  \xi 取值和x有关\\
  令h(x)=\frac{f''(\xi)}{2}，g(x)=(a-x)(x-b) \\
  \because g(x)\ge0,x\in[a,b] \\
  \therefore 使用积分中值定理 \int_a^b R(x)dx=
  -\frac{f''(\eta)}{2}\int_a^b (a-x)(x-b)dx
  $$

- 定理：若$f(x)\in C^4[a,b]$，Simpson公式误差估计
  $$
  \int_a^b f(x)dx-\frac{b-a}{6}[f(a)+f(\frac{a+b}{2})+f(b)]
  =-\frac{(b-a)^5}{2880}f^{(4)}(\eta) \\
  \int_a^b R(x)dx=\int_a^b \frac{f^{(4)}
  (\xi)}{4!}(x-x_0)(x-x_1)^2(x-x_2)dx \\
  再次使用积分中值定理
  $$
  

## 复合求积公式

从几何意义上观察，梯形和Simpson求积公式会产生较大的误差；对Newton-Cotes公式，n过大时稳定性得不到保证

- 复合梯形求积公式定义：把积分区间$[a,b]$划分$n$等分小区间，共$n+1$个求积节点，其中$x_k=a+kh,h=\frac{b-a}{n}$，复合梯形求积公式$T_n$表示为：
  $$
  \int_a^b f(x)dx=\int_{x_0}^{x_1}f(x)dx+\int_{x_1}^{x_2}f(x)dx
  +\cdots +\int_{x_{n-1}}^{x_n}f(x)dx \\
  = \sum\limits_{k=0}^{n-1}\int_{x_k}^{x_{k+1}}f(x)dx
  \approx \sum\limits_{k=0}^{n-1}\frac{x_{k+1}-x_{k}}{2}
  [f(x_{k+1})-f(x_{k})] \\
  =\frac{h}{2}[f(a)+f(b)+2\sum\limits_{k=1}^{n-1}f(a+kh)]
  $$

- 复合梯形求积公式误差

  定理：若$f(x)\in C^2[a,b]$，则对复合梯形求积公式$T_n$有：
  $$
  \int_a^bf(x)dx-T_n=-\frac{b-a}{12}h^2f''(\eta)
  $$
  应用：使用误差估计式判断$n$应该取多大才能满足需要的精度要求

  定理：积分近似值$T_n,T_{2n}$有如下关系
  $$
  T_{2n}=\frac{1}{2}[T_n+h\sum\limits_{k=1}^n f(a+(2k-1)\frac{b-a}{2n})]
  $$

- 复合Simpson求积公式定义：把积分区间$[a,b]$划分$n$等分，$n$为偶数，设$n=2m$，共有$2m+1$个求积节点，其中$x_k=a+kh$，$h=\frac{b-a}{n}$
  $$
  \int_{x_{2(k-1)}}^{x_{2k}}f(x)dx=\frac{h}{3}
  [f(x_{(2k-2)})+f(x_{(2k-1)})+f(x_{(2k)})] \\
  S_n=\int_a^b f(x)dx=\frac{h}{3}[f(a)+f(b)
  +4\sum\limits_{k=1}^mf(x_{2k-1})+2\sum\limits_{k=1}^mf(x_{2k})]
  $$

- 复合Simpson求积公式误差

  定理：若$f(x)\in C^4[a,b]$，则对复合Simposon求积公式$S_n$有
  $$
  \int_a^bf(x)dx-S_n=-\frac{b-a}{2880}(2h)^4f^{(4)}(\eta)
  $$
  

## 自动选取步长梯形法

复合梯形公式在求积分之前必须选定$n$，可以通过误差估计公式确定，也可以使用自动选取步长梯形法
$$
\int_a^b f(x)dx-T_n=-\frac{b-a}{12}h^2f''(\eta_n) \\
\int_a^b f(x)dx-T_{2n}=-\frac{b-a}{12}(\frac{h}{2})^2f''(\eta_{2n}) \\
T_{2n}-T_n=-\frac{b-a}{12}(\frac{h}{2})^2(4f''(\eta_n)-f''(\eta_{2n})) \\
\because 设n充分大的时候，f''(\eta_n)\approx f''(\eta_{2n}) \\
\therefore T_{2n}-T_n
\approx-\frac{b-a}{12}(\frac{h}{2})^2f''(\eta_{2n})\times3
=(\int_a^bf(x)dx-T_{2n})\times3 \\
\therefore 若要求|\int_a^b f(x)dx-T_{2n}|<\varepsilon \\
只需要 |T_{2n}-T_{n}|<3\varepsilon
$$
迭代计算$T_{2n}$时使用前面$T_{2n}$和$T_n$关系的定理$T_{2n}=\frac{1}{2}[T_n+h\sum\limits_{k=1}^n f(a+(2k-1)\frac{b-a}{2n})]$

## Richardson外推法

梯形法的递推化：复合求积方法可以提高求积精度，实际计算时如果精度不够，通过将步长逐次分半，提高求积公式的精度，以复合梯形积分为例，导出递推公式
$$
T_{2n}=\frac{1}{2}[T_n+h\sum\limits_{k=1}^n f(a+(2k-1)\frac{b-a}{2n})]
$$
外推技巧：从梯形公式触发，将区间$[a,b]$逐次二分可提高求积公式精度，$n$等分时，有
$$
I-T_n=-\frac{b-a}{12}h^2f''(\eta) \\
若记T_n=T(h),则T_{2n}=T(\frac{h}{2})
$$
可以证明梯形公式的**余项可以泰勒展开成级数形式**，得到如下定理：设$f(x)\in C^\infty[a,b]$，则有
$$
T(h)=I+a_1h^2+a_2h^4+\cdots+a_lh^{2l}+\cdots \\
系数a_l和h无关
$$
Richardson外推算法定义：通过**提升**计算$I$的近似值的**误差阶**，**提高数值计算精度**的方法；外推法是数值分析的重要技巧，只要真值和近似值的误差项可以展开成$h$的幂级数，可以使用外推法，提高精度，比如
$$
T(h)=I+a_1h^2+a_2h^4+\cdots+a_lh^{2l}+\cdots \\
T(\frac{h}{2})=I+a_1\frac{h^2}{4}+a_2\frac{h^4}{16}
+\cdots+a_l(\frac{h}{2})^{2l}+\cdots \\
从T_n和T_{2n}这两个求积公式构造新的求积公式 \\
S(h)=\frac{4T(\frac{h}{2})-T(h)}{3}=I+\beta_1h^4+\beta_2h^6+\cdots \\
系数\beta_l 和h无关
$$
可以看到，$T(n)$和$T({\frac{n}{2}})$的误差阶为$O(h^2)$，$S(h)$的误差阶为$O(h^4)$

同理，进一步地用$S(n),S(\frac{n}{2})$代替$T(n),T({\frac{n}{2}})$，重复上述步骤得到新的求积公式$C(h)$，误差阶为$O(h^8)$
$$
C(h)=\frac{16S(\frac{h}{2}-S(h))}{15} \\
C(h)=I+r_1h^6+r_2h^8+\cdots
$$

## Romberg求积法

- Richadson外推加速方法：$T_m^{(k)}$表示序列$\{T_0^{(k)}\}$的第$m$次加速值

- Romberg求积公式：
  $$
  T_m^{(k)}=\frac{4^m}{4^m-1}T_{m-1}^{(k+1)}
  -\frac{1}{4^m-1}T_{m-1}^{(k)}
  $$
  算法计算过程：

  - 取$k=0,h=b-a$，求$T_0^{(0)}=\frac{h}{2}[f(a)+f(b)]$
  - 求梯形值$T_0(\frac{b-a}{2^k})$，按递推公式计算$T_0^{(k)}$
  - 求加速值，当$|T_k^{(0)}-T_{k-1}^{(0)}|<\varepsilon$，终止计算

## Gauss 型求积公式

对一般的机械求积公式，含有$2n+2$个待定参数，$x_k,A_k$，当$x_k$为等距节点的插值求积公式的代数精度至少为$n$次
$$
\int_a^b f(x)dx\approx \sum\limits_{k=0}^n A_k f(x_k)
$$
如果适当选取$x_k$，有可能使求积公式具有$2n+1$次代数精度！

设带权积分$I=\int_a^bf(x)\rho(x)dx$，其中$\rho(x)$为权函数，其求积公式为：
$$
\int_a^bf(x)\rho(x)dx\approx \sum\limits_{k=0}^{n}A_kf(x_k)
$$


- Gauss求积公式定义：对于节点$x_k,(k=1,2,\cdots,n)$，求积公式具有$2n+1$次代数精度，称为**高斯型求积公式**，选取的求积节点称为**高斯点**

高斯点的求法

1. 选定权函数$\rho(x)$

2. 指定$q(x)$分别为$1,x,x^2,\cdots,x^{n-1}$，令$\int_a^b \rho(x)q(x)w_n(x)dx=0$

   得到$x_i,i=1,2,\cdots,n$的方程组，求出$x_i$

3. 再求出$A_k$
   $$
   A_k=\int_a^b\frac{\rho(x)w_n(x)}{(x-x_k)w_n'(x_k)}dx
   $$

# Chapt-5.解线性代数方程组的直接法

问题描述：$n$阶线性代数方程组
$$
AX=b\\
A=\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{bmatrix} , 
X=\begin{bmatrix} 
x_{1} \\ x_{2} \\ \vdots \\ x_{n}
\end{bmatrix} , 
b=\begin{bmatrix}
b_{1} \\ b{2} \\ \vdots \\ b_{n}
\end{bmatrix}
$$

## 高斯消去法

### 顺序高斯消去法

- 通过**初等变换**将方程组转化为等价的**三角形方程组**

$$
A^{(n)}X=b^{(n)}\\
A^{(n)}=\begin{bmatrix}
a_{11}^{(1)} & a_{12}^{(1)} & \cdots & a_{1n}^{(1)} \\
0 & a_{22}^{(2)} & \cdots & a_{2n}^{(2)} \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & a_{nn}^{(n)} \\
\end{bmatrix} , 
X=\begin{bmatrix} 
x_{1} \\ x_{2} \\ \vdots \\ x_{n}
\end{bmatrix} , 
b^{(n)}=\begin{bmatrix}
b_{1}^{(1)} \\ b{2}^{(2)} \\ \vdots \\ b_{n}^{(n)}
\end{bmatrix}
$$

- 消元计算公式归纳（代码填空）

```python
1. 输入A、b和ε
2. 消元
	for k=1 to n-1 do
        for i=k+1 to n do
            T=a[i,k]/a[k,k]
            b[i]-=T*b[k]
            for j=k+1 to n do
            a[i,j]-=T*a[k,j]
3. 回代
	if |a[n,n]<=ε
		求解失败
	else
		x[n]=b[n]/a[n,n]
		for i=n-1 downto 1 do
        	sum=0
            for j=i+1 to n
            	sum+=a[i,j]*x[j]
			x[i]=(b[i]-sum)/a[i,i]
```

- 高斯消去法计算量

### 列主元高斯消去法

- 顺序高斯消去法的问题：消元过程中，如果$a_{kk}^{(k)}\rarr0$，作为除数会导致其他元素量级增长和舍入误差的扩散，引起解的失真，**小主元是不稳定的根源**；列主元法通过交换行的初等变化选择最大的$a_{kk}^{(kk)}$
- 列主元伪代码：

```python
1. 输入A、b和ε
2. 选主元和消元
	for k=1 to n-1 do
		选主元：T=a[i_k,k]
		for i=k to n do
			T=max(T,a[i,k])
		if T<ε
			求解失败
		else
			交换A的第i_k行和第k行，交换b[t]和b[k]

		for i=k+1 to n do
			T=a[i,k]/a[k,k]
			b[i]-=T*b[k]
			for j=k+1 to n do
				a[i,j]-=T*a[k,j]
3. 回代
	if |a[n,n]<=ε
		求解失败
	else
		x[n]=b[n]/a[n,n]
		for i=n-1 downto 1 do
        	sum=0
            for j=i+1 to n
            	sum+=a[i,j]*x[j]
			x[i]=(b[i]-sum)/a[i,i]
```

- 列主元计算量

### 全主元高斯消去法

- 全主元和列主元类似，不同的是选取主元的范围不同；全主元在整个$A$中寻找绝对值最大的元素作为主元，将舍入误差控制在一个最小的范围；缺点是找主元和交换行列要花费大量机器时间
- 全主元伪代码

```python
1. 输入A、b和ε
2. for i=1 to n do d[i]=i //记录未知量位置的变换
3. 选主元和消元
	for k=1 to n-1 do
		选主元：T=a[i_k,j_k]
		for i=k to n do
			for j=k to n do
				T=max(T,a[i,j])
		if T<ε
			求解失败
		else
			交换A的第i_k行和第k行，交换b[t]和b[k]
			交换A的第j_k列和第k列，交换d[j_k]和d[k]

		for i=k+1 to n do
			T=a[i,k]/a[k,k]
			b[i]-=T*b[k]
			for j=k+1 to n do
				a[i,j]-=T*a[k,j]
4. 回代
	if |a[n,n]<=ε
		求解失败
	else
		z[n]=b[n]/a[n,n]
		for i=n-1 downto 1 do
        	sum=0
            for j=i+1 to n
            	sum+=a[i,j]*x[j]
			z[i]=(b[i]-sum)/a[i,i]
	for j=1 to n do
		x[d[j]]=z[j]
```

- 全主元计算量

## LU 分解法

- 高斯消去法将方程组$A^{(1)}X=b^{(1)}$通过**初等变换**等价转换为上三角型方程组$A^{(k)}X=b^{(k)}$，表示为$A^{(n)}=M_{n-1}M_{n-2}...M_{1}A^{(1)}$，则有$A^{(1)}=M_{1}^{-1}M_{2}^{-1}...M_{n-1}^{-1}A^{(n-1)}$，其中$M^{-1}_{i}$均为下三角矩阵且对角线元素为1
- 记$L=M_{1}^{-1}M_{2}^{-1}...M_{n-1}^{-1}$，$U=A^{(n)}$，只要方程$AX=b$的所有顺序主子式不为零，$A$一定可以分解成$A=LU$

$$
A=LU \\
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{12} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{bmatrix}=
\begin{bmatrix}
1 & \\
l_{12} & 1 \\
\vdots & \vdots & \ddots  \\
l_{n1} & l_{n2} & \cdots & 1 \\
\end{bmatrix}
\begin{bmatrix}
u_{11} & u_{12} & \cdots & u_{1n} \\
 & u_{22} & \cdots & u_{2n} \\
 &  & \ddots & \vdots \\
 &  &  & a_{nn} \\
\end{bmatrix} \\
先求出U的第一行和L的第一列 \\
u_{1j}=a_{1j}(j=1,2,\cdots,n)
l_{i1}=\frac{a_{i1}}{u_{11}}(i=1,2,\cdots,n)
\\
A的LU分解公式如下\\
\left\{
\begin{array}{**lr**}
u_{kj}=a_{kj}-\sum\limits_{m=1}^{k-1}l_{km}u_{mj} & (j=k,k+1,\cdots,n) \\
l_{ik}=\frac{a_{ik}-\sum\limits_{m=1}^{k=1}l_{im}u_{mk}}{ukk} & (i=k+1,k+2,\cdots,n) \\
\end{array}
\right. \\
LU分解后\\
\left\{
\begin{array}{**lr**}
Ly=b \\
Ux=y
\end{array}
\right.
$$

上述计算公式有如下的特点：$U$的元素按行逐行求，$L$的元素按列逐列求

- LU分解伪代码

```python
1. 输入A、b和ε
2. 
	for k=1 to n do
		for j=k to n do
			sum[k,j]=0
			for m=1 to k-1 do
            	sum[k,j]+=l[k,m]*u[m,k]
			u[k,j]=a[k,j]-sum[k,j]
        for i=k+1 to n do
        	sum[i,k]=0
        	for m=1 to k-1 do
        		sum[i,k]+=l[i,m]*u[m,k]
        	l[i,k]=(a[i,k]-sum[i,k])/u[k,k]
3. 求解 LY=b
4. 求解 UX=Y
```



## 对称正定矩阵的平方根法和LDLT分解法

- 正定矩阵：$n\times n$的实对称矩阵$A$是正定的**当且仅当**对于所有的非零实系数向量$X$，$X^TAX>0$

- 定理：对于线性代数方程组$AX=b$，$A$是$n$阶堆成矩阵，且**A的所有顺序主子式均不为零**，$A$可以分解为：
  $$
  A=LDL^T \\
  \begin{bmatrix}
  a_{11} & a_{12} & \cdots & a_{1n} \\
  a_{12} & a_{22} & \cdots & a_{2n} \\
  \vdots & \vdots & \ddots & \vdots \\
  a_{n1} & a_{n2} & \cdots & a_{nn} \\
  \end{bmatrix}=
  \begin{bmatrix}
  1 & \\
  l_{12} & 1 \\
  \vdots & \vdots & \ddots  \\
  l_{n1} & l_{n2} & \cdots & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
  d_{11} & \\
    & d_{22} \\
    &  & \ddots  \\
    &  &  & d_{nn} \\
  \end{bmatrix}
  \begin{bmatrix}
  1 & l_{21} & \cdots & l_{n1} \\
   & 1 & \cdots & l_{n2} \\
   &  & \ddots & \vdots \\
   &  &  & 1 \\
  \end{bmatrix} \\
  $$

- 定理：$n$阶对称正定矩阵$A$一定有$Clolesky$分解，是一种特殊的$LU$分解：

$$
A=L_1L_1^T \\
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{12} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{bmatrix}=
\begin{bmatrix}
l_{11} & \\
l_{12} & l_{22} \\
\vdots & \vdots & \ddots  \\
l_{n1} & l_{n2} & \cdots & l_{nn} \\
\end{bmatrix}
\begin{bmatrix}
l_{11} & l_{21} & \cdots & l_{n1} \\
 & l_{22} & \cdots & l_{n2} \\
 &  & \ddots & \vdots \\
 &  &  & l_{nn} \\
\end{bmatrix} \\
$$

- 平方根伪代码

```
1. 输入A、b和ε
2. 
	for k=1 to n do
		sum_1[k]=0
		for m=1 to k-1 do
        	sum_1[k]+=l[k,m]*l[k,m]
        S[k]=a[k,k]-sum[k]
       	
```

- 为了避免开方操作，可对$A$做LDLT分解法，LDLT分解法需要借助LU分解法

$$
\because A=LDR \\
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{12} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{bmatrix}=
\begin{bmatrix}
1 & \\
l_{12} & 1 \\
\vdots & \vdots & \ddots  \\
l_{n1} & l_{n2} & \cdots & 1 \\
\end{bmatrix}
\begin{bmatrix}
u_{11} & \\
  & u_{22} \\
  &  & \ddots  \\
  &  &  & u_{nn} \\
\end{bmatrix}
\begin{bmatrix}
1 & \frac{u_{12}}{u_{11}} & \cdots & \frac{u_{n1}}{u_{11}} \\
 & 1 & \cdots & \frac{u_{n2}}{u_{22}} \\
 &  & \ddots & \vdots \\
 &  &  & 1 \\
\end{bmatrix} \\
\therefore U=DL^T \\
$$

先利用LU分解法计算出$U$的第$k$行，由$U$的第$k$行得到$D$的第$k$个对角元素和$L$的第$k$列，即
$$
\left\{
\begin{array}{**lr**}
d_{i}=u_{ii} \\
l_{ik}=u_{ki}/u_{kk}
\end{array}
\right.
$$

## 向量和矩阵范数

### 向量范数

- 向量范数是$n$维欧几里得空间中长度概念的推广，一种距离的度量方式

- 向量范数定义：设向量$X\in R^n$，其范数$||X||$是非负实数，满足三个条件：

  - 非负性：$||X||=0$当且仅当$X=0$
  - 齐次性：$||\alpha X||=|\alpha|\cdot||X||$
  - 三角不等式：$||X+Y||\leq||X||+||Y||$
  - 常用范数：
    - 1范数：$||X||_1=\sum\limits_{i=1}^n|x_i|$
    - 2范数：$||X||_2=(\sum\limits_{i=1}^n|x_i|^2)^{\frac{1}{2}}$
    - $\infty$范数：$\max\limits_{1\le i\le n}|x_i|$
    - $p$范数：$||X||_p=(\sum\limits_{i=1}^{n}(|x_i|^p))^{\frac{1}{p}}$

- 范数等价定义：设$R^n$的两种范数$||\cdot||_\alpha$和$||\cdot||_\beta$，如果存在和$X$无关的两个正常数$C_1$和$C_2$，使得不等式$C_1||X||_\alpha\le ||X||_\beta\le C_2||X||_\alpha$成立，则称这两个范数等价

  - 定理：有限维空间上任何两种范数均等价（使用哪种范数都可以）

- 向量序列收敛定义：设$\{{X^{(k)}}\}$是$R^n$中的向量序列，如果有向量$X^*\in R^n$，使得
  $$
  \lim\limits_{k\rightarrow\infty}||X^{(k)}-X^*||=0
  $$
  则称$\{X^{(k)}\}$收敛于$X^*$，表示为
  $$
  \lim\limits_{k\rightarrow \infty}X^{(k)}=X^*
  $$

  - 定理：向量序列$\{X^{(k)}\}$收敛于$X^*$当且仅当$\lim\limits_{k\rightarrow \infty}x_j^{(k)}=x_j^*$，下标$j$表示向量的第$j$个分量

### 矩阵范数

- 矩阵范数定义：设矩阵$A\in R^{n\times n}$，其范数$||A||$是非负实数，满足四个条件

  - 非负性、齐次性、三角不等式
  - 乘法不等式：$||A\cdot B||\le ||A||\cdot||B||$

- 矩阵的算子范数定义：设$X\in R^n,A\in R^{n\times n}$,给定向量范数$||X||_v$，定义由向量诱导得到的矩阵范数
  $$
  ||A||_v=\max\limits_{X\ne0}\frac{||AX||_v}{||X||_v}
  =\max\limits_{||X||=1}||AX||_v
  $$

  - 矩阵范数和向量范数相容的定义：满足$||AX||\le ||A||\cdot||X||$
  - 定理：诱导矩阵范数$||A||$是相容的
  - 定理：$||A||=\max\limits_{||X||=1}||AX||$是一种矩阵范数

- 矩阵序列收敛定理：设$\{A^{(k)}\}$是$R^{n\times n}$的矩阵系列，如果有矩阵$A\in R^{n\times n}$，则
  $$
  \lim\limits_{k\rightarrow \infty}||A^{(k)}-A||=0
  $$
  当且仅当
  $$
  \lim\limits_{k\rightarrow \infty}a_{ij}^{(k)}=a^{ij}
  $$

### 谱半径

- 谱半径定义：$A\in R^{n\times n}$，其特征值为$\lambda_i$，$A$的谱半径表示为
  $$
  \rho(A)=\max\limits_{1\le i\le n}|\lambda_i|
  $$

  - 定理：$A$的谱半径不超过$A$的任意一个矩阵范数，$\rho(A)\le ||A||$
  - 定理：$A$的幂收敛于零，即$\lim\limits_{k\rightarrow \infty}A^k=0$当且仅当$\rho(A)<1$

# Chapt-6.解线性代数方程组的迭代法

解线性代数方程组的直接方法需要对系数矩阵分解，不能保持$A$的稀疏性，处理大型稀疏矩阵计算量大；迭代法充分利用了矩阵的稀疏性，有效控制计算量

## 简单迭代法（Jacobi迭代）

- 通过移项，将方程组$AX=b$变成下面的等价方程组
  $$
  \left\{
  \begin{array}{**lr**}
  x_1=\qquad b_{12}x_2 + b_{13}x_3 + \cdots \qquad b_{1n}x_n + g_1 \\
  x_1=b_{21}x_1 \qquad +b_{23}x_3 + \cdots \qquad b_{2n}x_n + g_n \\
  \vdots \\
  x_1=b_{n1}x_1 + b_{n2}x_2 + b_{n3}x_3 \cdots \qquad \qquad  + g_n \\
  \end{array}
  \right.
  \\
  其中 \\
  \left\{
  \begin{array}{**lr**}
  b_{ij}=-\frac{a_ij}{a_ii} \quad(i\ne j) \\
  b_{ii}=0 \\
  g_i=\frac{b_i}{a_{ii}}
  \end{array}
  \right.
  $$

- 矩阵形式表示为
  $$
  B=\begin{bmatrix}
  0 & b_{12} & \cdots & b_{1n} \\
  b_{21} & 0 & \cdots & b_{2n} \\
  \vdots & \vdots &  & \vdots \\
  b_{n1} & b_{n2} & \cdots & 0 \\
  \end{bmatrix}
  ,
  D=\begin{bmatrix}
  a_{11} &   &   &   \\
   & a_{22} &   &   \\
   &   & \ddots &   \\
   &   &   & a_{nn} \\
  \end{bmatrix}
  ,
  g=\begin{bmatrix}
  g_1\\
  g_2\\
  \vdots\\
  g_n
  \end{bmatrix}
  \\
  \because B=D^{-1}(D-A)=I-D^{-1}A \\
  g=D^{-1}b \\
  \therefore X=BX+g
  $$

- 雅可比迭代公式
  $$
  X^{(k+1)}=BX^k+g
  $$

- 收敛条件：$||X-Y||<\varepsilon$

## Seidel迭代法

Seidel迭代法是对Jacobi迭代法的加速，在迭代计算$x_i^{(k)}$时，使用之前计算好的序列$\{x_0^{(k)},\cdots,x_{i-1}^{(k)}\}$

- 将迭代矩阵$B=(b_{ij})_{n\times n}$分解为$B=L+U$，其中
  $$
  L=\begin{bmatrix}
  0 &   &   &   \\
  b_{21} & 0 &   &   \\
  \vdots & \vdots & \ddots &   \\
  b_{n1} & b_{n2} & \cdots & 0 \\
  \end{bmatrix}
  ,
  U=\begin{bmatrix}
  0 & b_{12} & \cdots & b_{1n} \\
    & 0 & \cdots & b_{2n} \\
    &   & \ddots & \vdots \\
    &   &   & 0 \\
  \end{bmatrix}
  $$

- Seidel迭代公式
  $$
  X^{(k+1)}=LX^{(k+1)}+UX^{(k)}+g
  $$

## 松弛法（SOR迭代）

松弛法迭代是对Seidel迭代法的加速，Seidel迭代法是松弛法的特例，使用之前计算好的$x_i^{(k)}$

- 松弛法迭代公式
  $$
  X^{(k+1)}=(1-\omega)X^{(k)}+\omega(LX^{(k+1)}+UX^{(k)}+g)
  $$
  $\omega$是松弛因子，大于1称为超松弛，小于1称为低松弛

## 迭代法收敛性理论

- 一般迭代法收敛定理：对于**任何**初始向量$X^{(0)}$和常数项$f$，迭代公式$X^{(k+1)}=MX^{(k)}+f$，向量序列**收敛**的充分必要条件是**迭代矩阵**$M$的谱半径$\rho(M)<1$

  - 使用到的定理：$\lim\limits_{k\rightarrow \infty}M^k=0\Longleftrightarrow \rho(M)<1$

  - 必要性证明：
    $$
    序列收敛到X^*，则有X^*=MX^*+f \\
    \varepsilon_k=X^{(k)}-X^*=M(X^{(k-1)}-X^*)=\cdots=M^k\varepsilon_0 \\
    \because序列收敛\\
    \therefore \lim\limits_{k\rightarrow\infty}\varepsilon_k =0
    =\lim\limits_{k\rightarrow\infty}M^k\varepsilon_0 \\
    \therefore \lim\limits_{k\rightarrow \infty}M^k=0，推出\rho(M)<1
    $$

  - 充分性证明：

    若$\rho(M)<1$，则1不是$M$的特征值且$I-M$非奇异，方程组$(I-M)X=f$有唯一解，记作$X^*$，递推式$\varepsilon_k=M^k\varepsilon_0$仍然成立
    $$
    \because \rho(M)<1 \therefore \lim\limits_{k\rightarrow \infty}M^k=0 \\
    \therefore \lim\limits_{k\rightarrow\infty}\varepsilon_k
    =\lim\limits_{k\rightarrow\infty}M^k\varepsilon_0 =0\\
    即\lim X^{(k)}\rightarrow \lim X^*
    $$

- 定理：若迭代矩阵$M$的范数$||M||=q<1$，则迭代公式$X^{(k+1)}=MX^{(k)}+f$对任何初始向量$X^{(0)}$一定收敛，且
  $$
  ||X^{(k)}-X^*||\le\frac{q}{1-q}||X^{(k)}-X^{(k-1)}||
  \le\frac{q^k}{1-q}||X^{(1)}-X^{(0)}||
  $$

  - 证明第一个推论：
    $$
    \because \rho(M)\le||M||且||M||<1 \therefore \rho(M)<1\\
    $$
    由上一个定理推出该迭代公式对任何初始向量收敛

  - 证明第二个推论：
    $$
    ||X^{(k)}-X^*||=||X^{(k)}-X^{(k+1)}+X^{(k+1)}-X^*|| \\
    \le||M||\cdot||X^{(k-1)}-X^{(k)}+X^{(k)}-X^*|| \\
    由三角不等式进一步推导 \\
    \le p||X^{(k)}-X^{(k-1)}||+p||X^{(k)}-X^*|| \\
    移项后得到\\
    ||X^{(k)}-X^*||\le\frac{q}{1-q}||X^{(k)}-X^{(k-1)}||
    $$
    递推继续证明
    $$
    \because ||X^{(k)}-X^{(k-1)}||=||MX^{(k-1)}+f-MX^{(k-2)}-f||\\
    \le ||M||\cdot||X^{(k-1)}-X^{(k-2)}|| \\
    \therefore \frac{q}{1-q}||X^{(k)}-X^{(k-1)}||
    \le\frac{q^k}{1-q}||X^{(1)}-X^{(0)}||
    $$

### 迭代矩阵谱半径和系数矩阵A的关系

- Jacobi迭代收敛的充要条件是下列行列式的所有根的绝对值小于1
  $$
  \begin{vmatrix}
  \lambda a_{11} & a_{12} & \cdots & a_{1n} \\
  a_{12} & \lambda a_{22} & \cdots & a_{2n} \\
  \vdots & \vdots & \ddots & \vdots \\
  a_{n1} & a_{n2} & \cdots & \lambda a_{nn} \\
  \end{vmatrix}=0
  $$
  推导：对迭代矩阵$B$收敛的充要条件是$\rho(B)<1$，所以需要先求解$B$的特征值
  $$
  \because BX=\lambda X
  \therefore (\lambda I-B)X=0 \\
  即求解行列式|\lambda I-B|=0 \\
  \because B=D^{-1}(D-A) \\
  |\lambda I-D^{-1}(D-A)|=0 \\
  |D^{-1}|\cdot|\lambda D-(D-A)|=0 \quad 又 \because |D^{-1}|\ne0 \\
  \therefore |\lambda D+(A-D)|=0
  $$

- Sidel迭代的充要条件是下列行列式的所有根的绝对值小于1
  $$
  \begin{vmatrix}
  \lambda a_{11} & a_{12} & \cdots & a_{1n} \\
  \lambda a_{12} & \lambda a_{22} & \cdots & a_{2n} \\
  \vdots & \vdots & \ddots & \vdots \\
  \lambda a_{n1} & \lambda a_{n2} & \cdots & \lambda a_{nn} \\
  \end{vmatrix}=0
  $$
  推导：
  $$
  (\lambda I-B)X=0\\
  \because B=(I-L)^{-1}U\\
  \therefore |\lambda I-(I-L)^{-1}U|=0 \\
  |\lambda (I-L)^{-1}(I-L)-(I-L)^{-1}U|=0 \\
  |\lambda (I-L)-U|=0 \\
  |\lambda D - \lambda DL -DU|=0
  $$

- 松弛迭代的充要条件是下列行列式的所有根的绝对值小于1
  $$
  \begin{vmatrix}
  (\lambda+\omega-1) a_{11} & a_{12} & \cdots & a_{1n} \\
  \omega\lambda a_{12} & (\lambda+\omega-1) a_{22} & \cdots & a_{2n} \\
  \vdots & \vdots & \ddots & \vdots \\
  \omega\lambda a_{n1} & \omega\lambda a_{n2} & \cdots & (\lambda+\omega-1) a_{nn} \\
  \end{vmatrix}=0
  $$







- 方阵不可约定义：矩阵$A$不能通过行交换和相应的列交换变成$\begin{bmatrix}A_{11} & A_{12} \\ 0 & A_{22} \end{bmatrix}$，其中$A_{11},A_{22}$为方阵

- 矩阵$A$强对角占优定义：$A=(a_{ij})_{n\times n}$，满足$|a_{ii}|\ge\sum\limits_{j\ne i}|a_{ij}|$，且至少有一个$i$值使得前面的不等式严格成立，则称$A$具有对角优势（弱对角占优）；如果所有$i$对不等式严格成立，则称$A$强对角占优

  - 定理：$A$强对角占优，或者$A$弱对角占优但不可约，则$\det A\ne 0$
  - 定理：$A$不可约的充要条件是$A$的邻接图是一个强连通图

- 定理：若$A$是强对角占优，或者$A$弱对角占优且不可约，则

  - Jacobi迭代、Seidel迭代一定收敛
  - 若松弛因子$\omega$满足$0< \omega\le 1$，则松弛迭代一定收敛

  定理分析：

  > 反证法，不收敛则存在特征值大于1，推出$\det$强对角占优，由定理的$\det$不为零，矛盾

  - Jacobi如果不收敛，则存在$|\lambda_0|\ge 1$，且满足
    $$
    \begin{vmatrix}
    \lambda_0 a_{11} & a_{12} & \cdots & a_{1n} \\
    \lambda_0 a_{12} & \lambda_0 a_{22} & \cdots & a_{2n} \\
    \vdots & \vdots & \ddots & \vdots \\
    \lambda_0 a_{n1} & \lambda_0 a_{n2} & \cdots & \lambda_0 a_{nn} \\
    \end{vmatrix}=0
    $$
    因为$|\lambda_0||a_{ii}|\ge |a_{ii}|\ge \sum\limits_{j\ne i}|a_{ij}|$，即上面的行列式强对角占优，行列式不为零（前面的定理），矛盾；Seidel类似

  - 松弛法类似，因为$\lambda_0\ge 1且0\le \omega\le 1$，推出$\lambda_0+\omega-1\ge \omega且\lambda_0(1-\omega)\ge (1-\omega)$，推出$\lambda+\omega-1\ge\omega\lambda$

- 定理：松弛法收敛的必要条件是$0<\omega< 2$

  定理：若矩阵$A$对称正定，且有$0<\omega<2$，则松弛法收敛
  
  定理：设分块对角阵$A$且$a_{ii}\ne 0$，Jacobi迭代的迭代矩阵$B$的特征值为实值且$0<\rho(B)<1$，则：当$0<\omega<2$时，松弛法收敛，最优松弛因子$\omega_{opt}=\frac{2}{1+\sqrt{1-\rho^2(B)}}$



## 例题

- 设$B\in R^{n\times n},\rho(B)>1$，但$B$有一个特征值满足$|\lambda|<1$，证明存在初始向量$x^{(0)}$，使得简单迭代式收敛
  $$
  \varepsilon^{(k)}=||x^{(k)}-x^*||=||Bx^{(k-1)}-Bx^*|| \\
  =||B(x^{(k-1)}-x^*)||= ||B^k(x^{(0)}-x^*)|| \\
  只需要证明存在|\lambda|<1时，存在||B||<1 \\
  \because By=\lambda y \therefore B^ky=\lambda^ky \\
  \lim\limits_{k\rightarrow\infty}||B^ky||=
  \lim\limits_{k\rightarrow\infty}||\lambda^ky||=0 \\
  \therefore 存在x^{(0)}=y+x^*使得迭代式关于它收敛 \\
  初始向量和特征向量y有关
  $$

- 设$A\in R^{(n\times n)}$对称正定，其最小和最大特征值分别是$\lambda_1,\lambda_2$，证明迭代法$X^{(k+1)}=X^{(k)}+\alpha(b-AX^{(k)})$收敛的充要条件是$0<\alpha<\frac{2}{\lambda_n}$，并求使得迭代举证谱半径最小的参数取值
  $$
  X^{(k+1)}=(I-\alpha A)X^{(k)}+\alpha b \\
  \rho(I-\alpha A)<1 \\
  $$



# Chapt-7.非线性方程和非线性方程组的数值解

求解$f(x)=0$的根，当函数为非线性方程，无一般的解析解解法可用，在满足一定精度要求下，求出方程的近似根

## 对分法

- 对分法定义：

  - 首先取区间$[a,b]$的中点$x_1=\frac{a+b}{2}$，将区间对分成小区间，$[a,x_1],[x_1,b]$
    - 如果$f(a)\cdot f(x_1)<0$，令$a_1=a,b_1=x_1$
    - 如果$f(b)\cdot f(x_1)<0$，令$a_1=x_1,b_1=b$
  - 重复此过程，得到每次长度减半的有根区间序列

- 对分法适合求有根区间的单实数根或奇重实根

  - 设$f(x)$在$[a,b]$上连续，$f(a)\cdot f(b)<0$，根据连续函数介值定理，区间内至少存在一点$\xi$，使得$f(\xi)=0$

- 收敛性分析

  - 当$k$足够大，有根区间$[a_k,b_k]$长度趋于零，区间内任意一点可作为根的近似值
    $$
    |x_k-\xi|\le\frac{1}{2}({b_k-a_k})=\frac{1}{2^{k+1}}(b-a) \\
    k\rightarrow\infty,x_k收敛于\xi
    $$

  - 收敛速度慢，不能求出偶重根（根两边函数值同号）

## 迭代法

- 迭代法定义：给定方程$f(x)=0$，用多种方法构造等价方程$x=\varphi(x)$，取定根的近似值$x_0$，构造序列
  $$
  x_{k+1}=\varphi(x_k)
  $$

  - 若$\{x_k\}$收敛，并且$\varphi(x)$连续，则有
    $$
    \lim\limits_{k\rightarrow \infty}x_{k+1}
    =\lim\limits_{k\rightarrow \infty}\varphi(x_k)
    =\varphi(\lim\limits_{k\rightarrow \infty}x_k)
    $$
    收敛序列的极限$x^*$是方程$x=\varphi(x)$的根，也是$f(x)$的根

  - 若$\{x_k\}$发散，迭代法失败

- 迭代法的几何意义
  $$
  \left\{
  \begin{array}{**lr**}
  y=x\\
  y=\varphi(x)\\
  \end{array}
  \right.
  $$
  求解方程和直线的交点的横坐标$x^*$

- 迭代法收敛条件

  - 定义：在根$x^*$的某个邻域$R:|x-x^*|\le \delta$中，对任意的$x_0\in R$，迭代公式$x_{k+1}=\varphi{(x_k)}$收敛，则称迭代在$x^*$附近局部收敛

  - 定理：设$x^*=\varphi(x^*)$，$\varphi '(x)$在$x^*$的某个邻域$R$内连续，并且$|\varphi '(x)|\le q,q<1$是常量，则

    - 对任意$x_0\in R$，由迭代公式$x_{k+1}=\varphi(x_k)$决定的序列$\{x_k\}$收敛于$x^*$

    - $|x_k-x^*|\le\frac{q^k}{1-q}|x_1-x_0|$

      证明：

    $$
    拉格朗日中值定理有\\
    x_k-x^*=\varphi(x_{k-1})-\varphi(x^*)=\varphi'(\xi)(x_{k-1}-x^*)\\
    递推得到\\
    |x_k-x^*|\le q|x_{k-1}-x^*|\le\cdots\le q^k|x_0-x^*|\\
    \lim\limits_{k\rightarrow \infty}|x_k-x^*|
    =\lim\limits_{k\rightarrow \infty}q^k|x_0-x^*|=0
    $$

    

    - $|x_k-x^*|\le\frac{1}{1-q}|x_{k+1}-x_k|$

      证明：

    $$
    x_k-x^*=x_k-x_{k+1}+x_{k+1}-x^*
    =x_k-x_{k+1}+\varphi'(\xi)(x_k-x^*)\\
    \therefore |x_k-x^*|\le|x_k-x_{k+1}|+q|x_k-x^*|\\
    (1-q)|x_k-x^*|\le|x_k-x_{k+1}|\\
    \therefore |x_k-x^*|\le \frac{1}{1-q}|x_{k+1}-x_k|\\
    又\because
    |x_{k+1}-x_k|\le q|x_k-x_{k-1}|\le \cdots\le q^k{|x_1-x_0|}|x_1-x_0|\\
    \Longrightarrow \\
    |x_k-x^*|\le\frac{q^k}{1-q}|x_1-x_0|
    $$

  - 定理：给定迭代方程$x=\varphi(x)$，若迭代方程满足：

    - 对任意的$x\in[a,b]$，有$\varphi(x)\in C[a,b]$
    - 对任意的$x,y\in [a,b]$，有$|\varphi(x)-\varphi(y)|\le q|x-y|,0\le q<1$

    则对任意的$x_0\in[a,b]$，迭代公式生成的序列收敛于$x=\varphi(x)$的根$x^*$

    证明：
    $$
    |x_k-x^*|\le q|x_{k-1}-x^*|\le q^k|x_1-x_0|\rightarrow0
    $$

- 迭代法的加速

  迭代公式收敛时，收敛速度取决于$|\varphi '(x)|$的大小，越接近1，收敛速度越慢

  松弛法：已知$\varphi(x_k)$和$x_k$是$x^*$的近似值，两个近似值的加权平均
  $$
  x_{k+1}=(1-w_k)x_k+w_k\varphi(x_k)\\
  x=(1-w)x+w\varphi(x)=\phi(x)\\
  $$
  令$\phi '(x)=1-w+w\varphi'(x)=0$，当$\varphi'(x) \ne 1$得到
  $$
  w=\frac{1}{1-\varphi'(x)}
  $$
  
  取$w_k=\frac{1}{1-\varphi '(x_k)}，1-w_k=\frac{-\varphi '(x_k)}{1-\varphi '(x_k)}$可以获得较好的加速效果
  
- 埃特金方法

  松弛法要计算导数$\varphi '(x_k)$，不方便。设$x^*$是准确解，$x_0$是近似根，取$x_1=\varphi(x_0),x_2=\varphi(x_1)$
  $$
  x^*=x_2+x^*-x_2=x_2+\varphi'(\xi)(x^*-x_1)\\
  用差商\\
  \frac{x_2-x_1}{x_1-x_0}=\frac{\varphi(x_1)-\varphi(x_0)}{x_1-x_0}\\
  代替\varphi'(\xi)，得到\\
  x^*\approx x_2+\frac{x_2-x_1}{x_1-x_0}(x^*-x_1)\\
  x^*\approx x_2-\frac{(x_2-x_1)^2}{x_2-2x_1+x_0}\\
  $$
  埃特金迭代公式
  $$
  \left\{
  \begin{array}{**lr**}
  x_k^{(1)}=\varphi(x_k)\\
  x_k^{(2)}=\varphi(x_k^{(1)})\\
  x_{k+1}= x^{(2)}_k-\frac{(x^{(2)}_k-x^{(1)}_k)^2}{x^{(2)}_k-2x^{(1)}_k+x_k}
  \end{array}
  \right.
  $$
  

## 牛顿法

由于$f(x)=0$是非线性方程，将非线性问题线性化，采用线性化的方法求解，将$f(x)$在$x_0$处泰勒展开
$$
f(x)=f(x_0)+f'(x_0)(x-x_0)+\frac{f''(\xi)}{2!}(x-x_0)^2
$$
用$p(x)=f(x_0)+f'(x_0)(x-x_0)=0$来近似$f(x)=0$，将曲线$f(x)$和X轴交点的横坐标近似为$p(x)$和X轴交点的横坐标，求得横坐标：
$$
x=x_0-\frac{f(x_0)}{f'(x_0)}
$$
牛顿法实质是一般迭代法用松弛法加速
$$
f(x)=0\Leftrightarrow x=x+f(x)=\varphi(x)\\
使用松弛法\varphi '(x)=1+f'(x)\\
w_k=\frac{1}{1-\varphi'(x_k)}=-\frac{1}{f'(x_k)}\\
推得牛顿法公式\\
x_{k+1}=x_k-\frac{f(x_k)}{f'(x_k)}
$$
牛顿法的收敛性质

- $p$阶收敛定义：设序列$\{x_k\}$收敛于$x^*$，令$\varepsilon_k=x^*-x_k$，设$k\rightarrow \infty$，有
  $$
  \frac{|\varepsilon_{k+1}|}{|\varepsilon_k|^p}\rightarrow c
  $$
  则称序列$p$阶收敛

  - $p=1$，线性收敛
  - $p=2$，二阶收敛
  - $1<p<2$，超线性收敛

- 定理：设$x^*=\varphi(x^*)$，在$x^*$的某个邻域内$\varphi^{(p)}(x)$连续，$p>1$是常量，并且满足
  $$
  \varphi^{(l)}(x^*)=0 \\
  \varphi^{(p)}(x^*)\ne 0
  $$
  则由$x_{k+1}=\varphi(x_k)$生成的序列$\{x_k\}$收敛于$x^*$，并且$p$阶收敛

  证明：

  $$
  \because \varphi '(x^*)=0,\therefore \{x_k\}收敛于x^* \\
  然后泰勒展开，\xi\in(x_k,x^*)\\
  x_{k+1}=\varphi(x_k)=\varphi(x^*)+\varphi'(x^*)(x_k-x^*)\\
  +\cdots+\frac{\varphi^{(p-1)}(x^*)}{(p-1)!}(x_k-x^*)^{p-1}+
  \frac{\varphi^{(p)}(\xi)}{p!}(x_k-x^*)^p\\
  又\because \varphi^{(1)}(x^*)=\varphi^{(2)}(x^*)=\cdots=\varphi^{(p-1)}(x^*)=0 \\
  \therefore |x_{k+1}-x^*|=|x_{k+1}-\varphi(x^*)|=|x_k-x^*|^p\frac{\varphi^{(p)}(\xi)}{p!}
  $$
  当$k\rightarrow \infty,x_k\rightarrow x^*$，从而$\xi_k\rightarrow x^*$，定理成立

牛顿法的收敛速度
$$
x=x-\frac{f(x)}{f'(x)}=\varphi(x),\varphi'(x)=\frac{f(x)f''(x)}{[f'(x)]^2}
$$
当$f'(x^*)\ne 0$时，$\varphi'(x^*)=0$，即牛顿法在单根附近至少二阶收敛，而在重根附近，牛顿法是线性收敛的

## 牛顿法求重根

设$f(x)=(x-x^*)^mg(x),g(x^*)\ne 0$，则$x^*$是函数的重根，此时$f(x^*)=f'(x^*)=\cdots f^{(m-1)}(x^*)=0,f^{(p)}(x^*)\ne 0$
$$
\varphi(x)=x-\frac{f(x)}{f'(x)}=x-\frac{(x-x^*)g(x)}{mg(x)+(x-x^*)g'(x)}\\
\varphi'(x^*)=1-\frac{1}{m}\ne 0，因此线性收敛
$$
此外，还能构造$\mu(x)=\frac{f(x)}{f'(x)}$，取代$f(x)$，具有二阶收敛

## 割线法

已知$f(x)=0$的近似根$x_k,x_{k-1}$，过两点$(x_{k-1},f(x_{k-1})),(x_{k},f(x_{k}))$作一条直线，写出直线方程
$$
\frac{y-f(x_k)}{x-x_k}=\frac{f(x_k)-f(x_{k-1})}{x_k-x_{k-1}}
$$
割线法：将曲线$f(x)=0$的横坐标近似求割线和X轴交点的横坐标
$$
x_{k+1}=x_k-\frac{f(x_k)}{f(x_k)-f(x_{k-1})}
$$
割线法需要两个初值$x_0,x_1$，也成为双点割线法

单点割线法：
$$
x_{k+1}=x_k-\frac{f(x_k)}{f(x_k)-f(x_0)}(x_k-x_0)
$$


## 解非线性方程组







三道大题

填空题10分 

计算题 7道题，每张一道 80分 第一第三10 其他12分

最后证明10分

2.3-2.7不考

拟合最小而成

正交多项不考

积分4.7 4.8不考

第五章 都靠

迭代法 迭代公式证明收敛性，

第七章：证明几节收敛，
